#! /bin/sh /usr/share/dpatch/dpatch-run
## 60_CVE-2014-4274.dpatch by RaphaÃ«l Hertzog <hertzog@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Fix CVE-2014-4274 (arbitrary code execution through temporary
## DP: file vulnerability).

@DPATCH@
diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' mysql-5.1-5.1.73~/storage/myisam/ha_myisam.cc mysql-5.1-5.1.73/storage/myisam/ha_myisam.cc
--- mysql-5.1-5.1.73~/storage/myisam/ha_myisam.cc	2014-10-21 11:30:44.000000000 +0200
+++ mysql-5.1-5.1.73/storage/myisam/ha_myisam.cc	2014-10-21 11:33:36.836539032 +0200
@@ -1108,7 +1108,6 @@
 
   param.db_name=    table->s->db.str;
   param.table_name= table->alias;
-  param.tmpfile_createflag = O_RDWR | O_TRUNC;
   param.using_global_keycache = 1;
   param.thd= thd;
   param.tmpdir= &mysql_tmpdir_list;
