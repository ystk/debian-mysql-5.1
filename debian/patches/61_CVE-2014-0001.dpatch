#! /bin/sh /usr/share/dpatch/dpatch-run
## 61_CVE-2014-0001.dpatch by RaphaÃ«l Hertzog <hertzog@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: Fix CVE-2014-0001

@DPATCH@
diff -urNad '--exclude=CVS' '--exclude=.svn' '--exclude=.git' '--exclude=.arch' '--exclude=.hg' '--exclude=_darcs' '--exclude=.bzr' mysql-5.1-5.1.73~/client/mysql.cc mysql-5.1-5.1.73/client/mysql.cc
--- mysql-5.1-5.1.73~/client/mysql.cc	2013-11-04 19:52:27.000000000 +0100
+++ mysql-5.1-5.1.73/client/mysql.cc	2014-10-21 12:43:43.554255003 +0200
@@ -1167,9 +1167,9 @@
 
   put_info("Welcome to the MySQL monitor.  Commands end with ; or \\g.",
 	   INFO_INFO);
-  sprintf((char*) glob_buffer.ptr(),
-	  "Your MySQL connection id is %lu\nServer version: %s\n",
-	  mysql_thread_id(&mysql), server_version_string(&mysql));
+  snprintf((char*) glob_buffer.ptr(), glob_buffer.alloced_length(),
+	   "Your MySQL connection id is %lu\nServer version: %s\n",
+	   mysql_thread_id(&mysql), server_version_string(&mysql));
   put_info((char*) glob_buffer.ptr(),INFO_INFO);
 
   put_info(ORACLE_WELCOME_COPYRIGHT_NOTICE("2000"), INFO_INFO);
